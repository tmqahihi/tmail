<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>MinhQuan Mail - TempMail</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root {
            --bg: #020617;
            --bg-soft: #020617;
            --card: #020924;
            --card-soft: #0b1220;
            --accent: #22c55e;
            --accent-soft: rgba(34, 197, 94, 0.1);
            --accent-strong: #16a34a;
            --border: #1f2937;
            --text: #e5e7eb;
            --muted: #9ca3af;
            --radius-lg: 18px;
            --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.65);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
                sans-serif;
            background:
                radial-gradient(circle at top left, #22c55e11, transparent 55%),
                radial-gradient(circle at bottom right, #38bdf811, transparent 55%),
                var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        .page {
            max-width: 1100px;
            margin: 0 auto;
            padding: 18px 16px 40px;
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 22px;
            gap: 16px;
        }

        .logo-wrap {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-circle {
            width: 34px;
            height: 34px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, #bbf7d0, #16a34a);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #022c22;
            font-weight: 800;
            font-size: 17px;
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);
        }

        .logo-text-main {
            font-weight: 700;
            letter-spacing: 0.04em;
            font-size: 16px;
        }

        .logo-text-sub {
            font-size: 11px;
            color: var(--muted);
        }

        .pill {
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            padding: 4px 9px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(
                120deg,
                rgba(15, 23, 42, 0.95),
                rgba(15, 23, 42, 0.7)
            );
            font-size: 12px;
            color: var(--muted);
        }

        .pill-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.25);
        }

        main {
            display: grid;
            grid-template-columns: minmax(0, 3fr) minmax(0, 2.1fr);
            gap: 18px;
        }

        @media (max-width: 840px) {
            main {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .card {
            border-radius: var(--radius-lg);
            background: radial-gradient(circle at top left,#0b1120,#020617);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-soft);
            padding: 18px 18px 16px;
        }

        .card-header {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 16px;
        }

        .eyebrow {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--accent);
            font-weight: 600;
        }

        .title {
            font-size: 20px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 13px;
            color: var(--muted);
        }

        .email-box {
            margin-top: 10px;
            border-radius: 999px;
            padding: 4px;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(148, 163, 184, 0.4);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .email-chip-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--muted);
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.5);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .email-value-wrap {
            flex: 1;
            display: flex;
            align-items: center;
            padding: 5px 12px;
            gap: 8px;
            min-width: 0;
        }

        .email-value {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                "Liberation Mono", "Courier New", monospace;
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .badge-demo {
            border-radius: 999px;
            padding: 2px 7px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            border: 1px solid rgba(234, 179, 8, 0.7);
            color: #facc15;
            background: rgba(202, 138, 4, 0.08);
        }

        .actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            border-radius: 999px;
            border: none;
            font-size: 13px;
            padding: 8px 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #111827;
            color: var(--text);
            transition: transform 0.12s ease, box-shadow 0.12s ease,
                background 0.12s ease, border-color 0.12s ease;
            border: 1px solid rgba(55, 65, 81, 0.75);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            border-color: transparent;
            color: #022c22;
            font-weight: 600;
            box-shadow: 0 16px 30px rgba(22, 163, 74, 0.35);
        }

        .btn-ghost {
            background: #020617;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 14px 30px rgba(15, 23, 42, 0.85);
            background: #020617;
            border-color: rgba(148, 163, 184, 0.9);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #22c55e, #4ade80);
            transform: translateY(-1px) scale(1.01);
        }

        .meta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
            font-size: 11px;
            color: var(--muted);
        }

        .meta-item {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 9px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(31, 41, 55, 0.85);
        }

        .meta-item strong {
            color: #e5e7eb;
            font-weight: 600;
        }

        .inbox-card {
            border-radius: var(--radius-lg);
            background: radial-gradient(circle at top left,#020617,#020617);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-soft);
            padding: 14px 14px 12px;
        }

        .inbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .inbox-title {
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .inbox-title span.icon {
            width: 18px;
            height: 18px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: rgba(34, 197, 94, 0.2);
            color: #bbf7d0;
            font-size: 11px;
        }

        .inbox-counter {
            font-size: 11px;
            color: var(--muted);
        }

        .inbox-list {
            margin-top: 4px;
            border-radius: 14px;
            border: 1px solid rgba(31, 41, 55, 0.9);
            background: #020617;
            overflow: hidden;
            max-height: 320px;
            overflow-y: auto;
        }

        .inbox-empty {
            padding: 16px 14px;
            font-size: 12px;
            color: var(--muted);
        }

        .msg-item {
            padding: 9px 11px;
            border-bottom: 1px solid rgba(31, 41, 55, 0.8);
            font-size: 12px;
            display: flex;
            flex-direction: column;
            gap: 2px;
            cursor: pointer;
            background: transparent;
            transition: background 0.12s ease;
        }

        .msg-item:hover {
            background: rgba(15, 23, 42, 0.8);
        }

        .msg-top {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            align-items: center;
        }

        .msg-from {
            font-weight: 500;
            color: #e5e7eb;
        }

        .msg-subject {
            font-size: 11px;
            color: var(--muted);
        }

        .msg-time {
            font-size: 11px;
            color: var(--muted);
        }

        .msg-badge {
            font-size: 10px;
            border-radius: 999px;
            padding: 2px 7px;
            border: 1px solid rgba(56, 189, 248, 0.7);
            color: #7dd3fc;
        }

        .msg-body {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 3px;
        }

        .inbox-footer {
            margin-top: 7px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            color: var(--muted);
        }

        footer {
            margin-top: 20px;
            font-size: 11px;
            color: var(--muted);
            text-align: center;
        }

        footer a {
            color: #38bdf8;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="page">
        <header>
            <div class="logo-wrap">
                <div class="logo-circle">MQ</div>
                <div>
                    <div class="logo-text-main">MinhQuan Mail</div>
                    <div class="logo-text-sub">TempMail ch·∫°y b·∫±ng API 1secmail</div>
                </div>
            </div>
            <div class="pill">
                <span class="pill-dot"></span>
                <span>Ho·∫°t ƒë·ªông ¬∑ Frontend + API (nh·∫≠n mail th·∫≠t)</span>
            </div>
        </header>

        <main>
            <!-- C·ªôt tr√°i -->
            <section class="card">
                <div class="card-header">
                    <div class="eyebrow">TEMPMAIL</div>
                    <div class="title">T·∫°o email t·∫°m th·ªùi ƒë·ªÉ test</div>
                    <div class="subtitle">
                        Email ƒë∆∞·ª£c t·∫°o t·ª´ API <code>1secmail.com</code>. Ph√π h·ª£p ƒë·ªÉ test ƒëƒÉng k√Ω t√†i kho·∫£n,
                        nh·∫≠n m√£ x√°c th·ª±c,... Kh√¥ng d√πng cho d·ªØ li·ªáu quan tr·ªçng.
                    </div>
                </div>

                <div class="email-box">
                    <div class="email-chip-label">
                        <span>EMAIL HI·ªÜN T·∫†I</span>
                    </div>
                    <div class="email-value-wrap">
                        <div class="email-value" id="emailValue">ƒêang t·∫°o...</div>
                        <span class="badge-demo">TEMP MAIL</span>
                    </div>
                </div>

                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px;gap:10px;flex-wrap:wrap;">
                    <div class="actions">
                        <button class="btn btn-primary" id="btnGenerate">
                            üîÑ T·∫°o email m·ªõi
                        </button>
                        <button class="btn btn-ghost" id="btnCopy">
                            üìã Sao ch√©p
                        </button>
                    </div>

                    <div style="text-align:right;">
                        <div style="font-size:11px;color:var(--muted);">Th·ªùi gian hi·ªán t·∫°i (GMT+7)</div>
                        <div style="font-size:13px;font-weight:500;" id="timeDisplay">
                            --
                        </div>
                    </div>
                </div>

                <div class="meta-row">
                    <div class="meta-item">
                        <strong>Mi·ªÖn ph√≠</strong>
                        <span>¬∑ GitHub Pages + 1secmail API</span>
                    </div>
                    <div class="meta-item">
                        <strong>Kh√¥ng c·∫ßn server</strong>
                        <span>¬∑ To√†n b·ªô ch·∫°y tr√™n frontend</span>
                    </div>
                </div>
            </section>

            <!-- C·ªôt ph·∫£i -->
            <aside class="inbox-card">
                <div class="inbox-header">
                    <div class="inbox-title">
                        <span class="icon">üì•</span>
                        <span>H·ªôp th∆∞</span>
                    </div>
                    <div class="inbox-counter">
                        <span id="inboxCount">0</span> email
                    </div>
                </div>

                <div class="inbox-list" id="inboxList">
                    <div class="inbox-empty">Ch∆∞a c√≥ email n√†o...</div>
                </div>

                <div class="inbox-footer">
                    <span>G·ª≠i th·ª≠ 1 email t·ª´ Gmail t·ªõi ƒë·ªãa ch·ªâ b√™n tr√°i ƒë·ªÉ test.</span>
                </div>
            </aside>
        </main>

        <footer>
            ¬© 2025 MinhQuan Mail ‚Äì X√¢y b·∫±ng GitHub Pages + 1secmail API.
        </footer>
    </div>

    <script>
        const emailEl = document.getElementById("emailValue");
        const btnGenerate = document.getElementById("btnGenerate");
        const btnCopy = document.getElementById("btnCopy");
        const timeDisplay = document.getElementById("timeDisplay");
        const inboxList = document.getElementById("inboxList");
        const inboxCount = document.getElementById("inboxCount");

        const BASE_URL = "https://www.1secmail.com/api/v1/";

        let currentEmail = "";
        let currentLogin = "";
        let currentDomain = "";
        let inboxTimer = null;

        function updateClock() {
            const now = new Date();
            const pad = (n) => String(n).padStart(2, "0");
            const timeStr =
                pad(now.getHours()) +
                ":" +
                pad(now.getMinutes()) +
                ":" +
                pad(now.getSeconds());
            const dateStr =
                pad(now.getDate()) +
                "/" +
                pad(now.getMonth() + 1) +
                "/" +
                now.getFullYear();
            timeDisplay.textContent = `${timeStr} ¬∑ ${dateStr}`;
        }
        setInterval(updateClock, 1000);
        updateClock();

        async function apiRequest(params) {
            const url = new URL(BASE_URL);
            Object.entries(params).forEach(([k, v]) =>
                url.searchParams.append(k, v)
            );
            const res = await fetch(url.toString());
            if (!res.ok) throw new Error("API error");
            return res.json();
        }

        async function generateEmail() {
            try {
                emailEl.textContent = "ƒêang t·∫°o email...";
                const list = await apiRequest({
                    action: "genRandomMailbox",
                    count: 1,
                });
                const email = Array.isArray(list) ? list[0] : String(list);
                currentEmail = email;
                const [login, domain] = email.split("@");
                currentLogin = login;
                currentDomain = domain;

                emailEl.textContent = email;

                if (inboxTimer) clearInterval(inboxTimer);
                await loadInbox();
                inboxTimer = setInterval(loadInbox, 5000);
            } catch (e) {
                console.error(e);
                emailEl.textContent = "L·ªói t·∫°o email, th·ª≠ l·∫°i...";
            }
        }

        async function loadInbox() {
            if (!currentLogin || !currentDomain) return;
            try {
                const messages = await apiRequest({
                    action: "getMessages",
                    login: currentLogin,
                    domain: currentDomain,
                });

                renderInbox(Array.isArray(messages) ? messages : []);
            } catch (e) {
                console.error(e);
            }
        }

        async function readMessage(id) {
            try {
                const msg = await apiRequest({
                    action: "readMessage",
                    login: currentLogin,
                    domain: currentDomain,
                    id: id,
                });
                if (!msg) return;
                alert(
                    "T·ª´: " +
                        msg.from +
                        "\nCh·ªß ƒë·ªÅ: " +
                        msg.subject +
                        "\n\n" +
                        (msg.textBody || msg.body || "[Kh√¥ng c√≥ n·ªôi dung]")
                );
            } catch (e) {
                console.error(e);
            }
        }

        function renderInbox(items) {
            inboxList.innerHTML = "";
            inboxCount.textContent = items.length;

            if (!items.length) {
                inboxList.innerHTML =
                    '<div class="inbox-empty">Ch∆∞a c√≥ email n√†o. G·ª≠i th·ª≠ 1 mail t·ªõi ƒë·ªãa ch·ªâ b√™n tr√°i r·ªìi ƒë·ª£i v√†i gi√¢y.</div>';
                return;
            }

            items
                .slice()
                .reverse()
                .forEach((m) => {
                    const div = document.createElement("div");
                    div.className = "msg-item";
                    div.innerHTML = `
                        <div class="msg-top">
                            <div>
                                <div class="msg-from">${m.from}</div>
                                <div class="msg-subject">${m.subject || "(Kh√¥ng c√≥ ch·ªß ƒë·ªÅ)"}</div>
                            </div>
                            <div style="text-align:right;display:flex;flex-direction:column;gap:4px;align-items:flex-end;">
                                <div class="msg-time">${m.date || ""}</div>
                                <div class="msg-badge">INBOX</div>
                            </div>
                        </div>
                    `;
                    div.addEventListener("click", () => readMessage(m.id));
                    inboxList.appendChild(div);
                });
        }

        async function copyEmail() {
            if (!currentEmail) return;
            try {
                if (navigator.clipboard?.writeText) {
                    await navigator.clipboard.writeText(currentEmail);
                    alert("ƒê√£ sao ch√©p email: " + currentEmail);
                } else {
                    const temp = document.createElement("textarea");
                    temp.value = currentEmail;
                    document.body.appendChild(temp);
                    temp.select();
                    document.execCommand("copy");
                    document.body.removeChild(temp);
                    alert("ƒê√£ sao ch√©p email");
                }
            } catch (e) {
                alert("Kh√¥ng sao ch√©p ƒë∆∞·ª£c, copy tay gi√∫p m√¨nh nh√©!");
            }
        }

        btnGenerate.addEventListener("click", generateEmail);
        btnCopy.addEventListener("click", copyEmail);

        // t·∫°o email l·∫ßn ƒë·∫ßu
        generateEmail();
    </script>
</body>
</html>
